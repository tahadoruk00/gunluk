<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>YKS & S√ºre√ß Takip</title>
    
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-database-compat.js"></script>

    <style>
        :root { --dark: #1e272e; --tyt: #3498db; --ayt: #9b59b6; --red: #e84118; --bg: #f5f6fa; --grad: linear-gradient(135deg, #6c5ce7, #a29bfe); --green: #2ecc71; }
        body { font-family: -apple-system, system-ui, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; background: var(--bg); margin: 0; padding: 15px; display: flex; justify-content: center; color: var(--dark); }
        .container { background: white; width: 100%; max-width: 420px; border-radius: 35px; padding: 20px; box-shadow: 0 15px 50px rgba(0,0,0,0.1); }
        
        .quote-card { background: var(--grad); color: white; padding: 20px; border-radius: 25px; margin-bottom: 20px; position: relative; overflow: hidden; }
        #dailyQuote { font-size: 14px; font-weight: 600; font-style: italic; line-height: 1.5; margin: 0; position: relative; z-index: 1; }
        .quote-author { font-size: 11px; opacity: 0.8; margin-top: 8px; display: block; font-weight: 700; text-transform: uppercase; }

        .exam-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 15px; }
        .stat-card { background: #fff; padding: 12px; border-radius: 20px; text-align: center; border: 1px solid #f1f1f1; }
        .stat-val { font-size: 15px; font-weight: 800; display: block; margin-bottom: 2px; }
        .stat-label { font-size: 9px; color: #95a5a6; font-weight: 700; text-transform: uppercase; }

        .process-card { background: #fff; padding: 15px; border-radius: 20px; text-align: center; border: 1px solid #fceaea; margin-bottom: 20px; }
        .process-val { font-size: 16px; font-weight: 800; color: var(--red); display: block; }
        
        .user-selector { display: flex; gap: 12px; margin-bottom: 20px; }
        .profile-card { flex: 1; text-align: center; cursor: pointer; opacity: 0.5; transition: 0.3s; padding: 15px; border-radius: 22px; background: #f8f9fa; position: relative; border: 2px solid transparent; }
        .profile-card.active { opacity: 1; background: #fff; border-color: var(--tyt); transform: translateY(-3px); box-shadow: 0 5px 15px rgba(52, 152, 219, 0.2); }
        .edit-name-btn { position: absolute; top: 5px; right: 8px; font-size: 12px; color: #ccc; }

        textarea { width: 100%; height: 100px; padding: 15px; border-radius: 20px; border: 2px solid #f1f1f1; box-sizing: border-box; font-family: inherit; resize: none; outline: none; font-size: 15px; transition: 0.3s; }
        textarea:focus { border-color: var(--tyt); }

        .custom-file-upload { display: flex; align-items: center; justify-content: center; gap: 8px; background: #f8f9fa; padding: 12px; border-radius: 15px; cursor: pointer; font-weight: 700; font-size: 13px; margin-top: 10px; border: 2px dashed #eee; }

        .save-btn { background: var(--dark); color: white; border: none; padding: 18px; border-radius: 22px; width: 100%; font-weight: 800; cursor: pointer; margin: 15px 0; font-size: 15px; transition: 0.4s; }
        .save-btn.success { background: var(--green) !important; }

        .archive-display { background: #f9f9f9; border-radius: 25px; padding: 15px; margin-bottom: 20px; border: 1px solid #eee; min-height: 50px; }
        .archive-title { font-size: 11px; font-weight: 800; color: #95a5a6; text-transform: uppercase; margin-bottom: 10px; display: block; }
        .archive-content { font-size: 15px; line-height: 1.5; color: #2c3e50; white-space: pre-wrap; }
        .archive-image { width: 100%; border-radius: 15px; margin-top: 10px; display: block; }
        .empty-msg { font-style: italic; color: #ccc; font-size: 13px; text-align: center; padding: 10px; }

        .calendar-box { background: #fff; border-radius: 25px; padding: 15px; border: 1px solid #f1f1f1; }
        .cal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; font-weight: 800; }
        .cal-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 4px; }
        .cal-day { font-size: 12px; padding: 8px 0; border-radius: 10px; cursor: pointer; text-align: center; position: relative; }
        .cal-day.selected { background: var(--tyt) !important; color: white !important; font-weight: bold; }
        
        #previewContainer img { width: 100%; border-radius: 20px; margin-top: 10px; border: 2px solid var(--tyt); }
        .nav-btn { background: #f1f2f6; border: none; width: 28px; height: 28px; border-radius: 8px; cursor: pointer; }
    </style>
</head>
<body>

<div class="container">
    <div class="quote-card">
        <p id="dailyQuote">...</p>
        <span class="quote-author" id="quoteAuthor"></span>
    </div>

    <div class="exam-grid">
        <div class="stat-card"><span class="stat-val" id="tytCount" style="color: var(--tyt);">--:--</span><span class="stat-label">TYT 2026</span></div>
        <div class="stat-card"><span class="stat-val" id="aytCount" style="color: var(--ayt);">--:--</span><span class="stat-label">AYT 2026</span></div>
    </div>

    <div class="process-card">
        <span class="process-val" id="awayLive">...</span>
        <span class="stat-label">S√ºre√ß Takibi</span>
    </div>

    <div class="user-selector">
        <div class="profile-card" id="card-sude" onclick="toggleDiary('sude')">
            <span class="edit-name-btn" onclick="renameUser('sude', event)">‚úé</span>
            <span id="name-sude">...</span>
        </div>
        <div class="profile-card" id="card-taha" onclick="toggleDiary('taha')">
            <span class="edit-name-btn" onclick="renameUser('taha', event)">‚úé</span>
            <span id="name-taha">...</span>
        </div>
    </div>

    <div id="diary-area" style="display:none;">
        <textarea id="noteInput" placeholder="Yeni bir ≈üeyler ekle..."></textarea>
        <label class="custom-file-upload">
            <input type="file" id="fileInput" accept="image/*" style="display: none;" onchange="previewImage()">
            üì∏ Fotoƒüraf Se√ß
        </label>
        <div id="previewContainer"></div>
        <button id="saveButton" class="save-btn" onclick="saveToFirebase()">G√ºn√º Ar≈üivle</button>

        <div class="archive-display" id="archiveBox">
            <span class="archive-title" id="archiveDateTitle">Ar≈üiv</span>
            <div id="archiveContent" class="archive-content"></div>
            <div id="archiveImageContainer"></div>
        </div>

        <div class="calendar-box">
            <div class="cal-header">
                <button class="nav-btn" onclick="changeMonth(-1)">‚Äπ</button>
                <span id="monthYear">...</span>
                <button class="nav-btn" onclick="changeMonth(1)">‚Ä∫</button>
            </div>
            <div class="cal-grid">
                <div class="weekday" style="font-size: 9px; text-align: center; color: #ccc;">PT</div><div class="weekday" style="font-size: 9px; text-align: center; color: #ccc;">SA</div><div class="weekday" style="font-size: 9px; text-align: center; color: #ccc;">√áA</div><div class="weekday" style="font-size: 9px; text-align: center; color: #ccc;">PE</div><div class="weekday" style="font-size: 9px; text-align: center; color: #ccc;">CU</div><div class="weekday" style="font-size: 9px; text-align: center; color: #ccc;">CT</div><div class="weekday" style="font-size: 9px; text-align: center; color: #ccc;">PZ</div>
            </div>
            <div class="cal-grid" id="calendarGrid" style="margin-top:8px;"></div>
        </div>
    </div>
</div>

<script>
    const firebaseConfig = {
        apiKey: "AIzaSyAUnANfxQb3-8rG-ws3l08XD5vGWGdtb2Y",
        authDomain: "yks-gunluk.firebaseapp.com",
        databaseURL: "https://yks-gunluk-default-rtdb.europe-west1.firebasedatabase.app",
        projectId: "yks-gunluk",
        storageBucket: "yks-gunluk.firebasestorage.app",
        messagingSenderId: "603273107081",
        appId: "1:603273107081:web:06fc327f84cb1fddd01858"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    let currentUserId = '';
    let selectedImageBase64 = "";
    let viewDate = new Date();
    let selectedDateStr = new Date().toLocaleDateString('en-CA');

    function toggleDiary(userId) {
        const diaryArea = document.getElementById('diary-area');
        if (currentUserId === userId) {
            currentUserId = '';
            diaryArea.style.display = 'none';
            document.querySelectorAll('.profile-card').forEach(c => c.classList.remove('active'));
        } else {
            currentUserId = userId;
            document.querySelectorAll('.profile-card').forEach(c => c.classList.remove('active'));
            document.getElementById('card-' + userId).classList.add('active');
            diaryArea.style.display = 'block';
            selectDay(new Date().toLocaleDateString('en-CA'));
        }
    }

    function selectDay(dateStr) {
        selectedDateStr = dateStr;
        const options = { day: 'numeric', month: 'long', year: 'numeric' };
        document.getElementById('archiveDateTitle').innerText = new Date(dateStr).toLocaleDateString('tr-TR', options) + " Ar≈üivi";
        renderCalendar();
        loadArchive(); 
    }

    function loadArchive() {
        const contentDiv = document.getElementById('archiveContent');
        const imgDiv = document.getElementById('archiveImageContainer');
        if (!currentUserId) return;

        db.ref(`notes/${currentUserId}/${selectedDateStr}`).once('value', snap => {
            const data = snap.val();
            if (data) {
                contentDiv.innerHTML = data.text || "";
                imgDiv.innerHTML = data.image ? `<img src="${data.image}" class="archive-image">` : "";
            } else {
                contentDiv.innerHTML = `<div class="empty-msg">Bu tarihte senin bir kaydƒ±n yok.</div>`;
                imgDiv.innerHTML = "";
            }
        });
    }

    function saveToFirebase() {
        const inputField = document.getElementById('noteInput');
        const text = inputField.value;
        const btn = document.getElementById('saveButton');
        if(!text && !selectedImageBase64) return;

        db.ref(`notes/${currentUserId}/${selectedDateStr}`).set({
            text: text,
            image: selectedImageBase64,
            timestamp: Date.now()
        }).then(() => {
            inputField.value = "";
            selectedImageBase64 = "";
            document.getElementById('previewContainer').innerHTML = "";
            btn.classList.add('success');
            btn.innerText = "‚úì Ar≈üivlendi";
            loadArchive();
            setTimeout(() => {
                btn.classList.remove('success');
                btn.innerText = "G√ºn√º Ar≈üivle";
            }, 2000);
        });
    }

    function renderCalendar() {
        const grid = document.getElementById("calendarGrid");
        grid.innerHTML = "";
        const month = viewDate.getMonth();
        const year = viewDate.getFullYear();
        document.getElementById("monthYear").innerText = new Intl.DateTimeFormat('tr-TR', { month: 'long', year: 'numeric' }).format(viewDate);
        const firstDay = new Date(year, month, 1).getDay();
        const daysInMonth = new Date(year, month + 1, 0).getDate();
        const offset = firstDay === 0 ? 6 : firstDay - 1;
        for(let i=0; i<offset; i++) grid.innerHTML += `<div></div>`;
        for(let d=1; d<=daysInMonth; d++) {
            const dateStr = `${year}-${String(month+1).padStart(2,'0')}-${String(d).padStart(2,'0')}`;
            const isSelected = dateStr === selectedDateStr ? 'selected' : '';
            grid.innerHTML += `<div class="cal-day ${isSelected}" onclick="selectDay('${dateStr}')">${d}</div>`;
        }
    }

    function previewImage() {
        const file = document.getElementById('fileInput').files[0];
        if (file) {
            const reader = new FileReader();
            reader.onloadend = () => {
                selectedImageBase64 = reader.result;
                document.getElementById('previewContainer').innerHTML = `<img src="${selectedImageBase64}" style="width:100%; border-radius:15px; margin-top:10px;">`;
            };
            reader.readAsDataURL(file);
        }
    }

    function changeMonth(val) { viewDate.setMonth(viewDate.getMonth() + val); renderCalendar(); }
    
    function updateTimers() {
        const now = new Date();
        const tyt = new Date("June 20, 2026 10:15:00");
        const ayt = new Date("June 21, 2026 10:15:00");
        const start = new Date("2026-02-08T22:35:00");
        const calc = (target) => {
            const diff = target - now;
            return `${Math.floor(diff/86400000)}g ${Math.floor((diff%86400000)/3600000)}s ${Math.floor((diff%3600000)/60000)}dk`;
        }
        document.getElementById("tytCount").innerText = calc(tyt);
        document.getElementById("aytCount").innerText = calc(ayt);
        const diffS = now - start;
        document.getElementById("awayLive").innerText = `${Math.floor(diffS/86400000)}g ${Math.floor((diffS%86400000)/3600000)}s ${Math.floor((diffS%3600000)/60000)}dk`;
    }

    const quotes = [{s:"Gelecek, hayallerine inananlarƒ±ndƒ±r.",a:"Roosevelt"},{s:"Zorluklar ba≈üarƒ±yƒ± deƒüerli kƒ±lar.",a:"Atat√ºrk"},{s:"Durmadƒ±ƒüƒ±n s√ºrece yava≈ü gitmen m√ºhim deƒüil.",a:"Konf√º√ßy√ºs"}];
    function setRandomQuote() {
        const q = quotes[Math.floor(Math.random() * quotes.length)];
        document.getElementById('dailyQuote').innerText = q.s;
        document.getElementById('quoteAuthor').innerText = "‚Äî " + q.a;
    }
    function syncNames() { db.ref('settings/names').on('value', snap => { const names = snap.val() || { sude: "Sude", taha: "Taha" }; document.getElementById('name-sude').innerText = names.sude; document.getElementById('name-taha').innerText = names.taha; }); }
    function renameUser(id, event) { event.stopPropagation(); const newName = prompt("Yeni isim:"); if (newName) db.ref('settings/names').update({ [id]: newName }); }

    setRandomQuote();
    syncNames();
    setInterval(updateTimers, 60000);
    updateTimers();
</script>
</body>
</html>
